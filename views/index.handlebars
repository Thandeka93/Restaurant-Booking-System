<form action="/book" method="post" id="bookingForm">

    <h2 class="title is-2">Book a table</h2>

    <div class="notification is-danger is-light">
        {{!-- you can remove the button below if you want --}}
        {{#if flash.error}}
        <button class="delete"></button>
        {{flash.error}}
        Error Flash messages goes here...
        <a href="https://bulma.io/documentation/elements/notification/">Read here if you wanna change the style</a>
          {{/if}}
    </div>
    <div class="notification is-success is-light">
        {{!-- you can remove the button below if you want --}}
         {{#if flash.success}}
        <button class="delete"></button>
        {{flash.success}}
        Success Flash messages goes here...
        <a href="https://bulma.io/documentation/elements/notification/">Read here if you wanna change the style</a>
          {{/if}}
    </div>


    <div class="columns">

        {{#each tables}}

        <div class="column">
            <div class="panel">
                <p class="panel-heading">
                    Table XYZ
                </p>
                <div class="panel-block">
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <img src="./images/table.png" width="80">
                        </div>
                    </div>
                </div>
                <div class="panel-block">

                    <div class="field is-horizontal">
                        <div class="field-label is-normal">

                            <label class="label">Table capacity</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <p class="control">
                                    <input class="input is-static" type="email" value="5" readonly>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-block">

                    <div class="control">
                        {{#if booked}}
                        <img src="./images/reserved.png" width="60">
                        {{else}}
                        <label class="radio">
                            <input type="radio" name="tableId" id="tableId">
                            Book this table
                        </label>
                        {{/if}}
                    </div>


                </div>
            </div>
        </div>


        {{/each}}
    </div>

    <div class="columns">
        <div class="column is-3">
            <div class="field">
                <label for="" class="label">Number of people in booking</label>
                <div class="control">
                    <input class="input" type="text" name="booking_size">
                </div>
            </div>
        </div>
        <div class="column is-3">
            <div class="field">
                <label for="" class="label">Username</label>
                <div class="control">
                    <input class="input" type="text" name="username">
                </div>
            </div>
        </div>
        <div class="column is-3">
            <div class="field">
                <label for="" class="label">Phone number</label>
                <div class="control">
                    <input class="input" type="text" name="phone_number">
                </div>
            </div>
        </div>
    </div>

    <div class="field">
        <input class="button is-primary" type="submit" value="Book">
    </div>
</form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const bookingForm = document.getElementById("bookingForm");
    
    bookingForm.addEventListener("submit", async function (event) {
        event.preventDefault();

        // Check if the radio button is checked
        const selectedTable = document.querySelector('input[name="tableId"]:checked');
        if (!selectedTable) {
            alert("Please select a table to book.");
            return;
        }

        // Validate username and phone number
        const usernameInput = document.querySelector('input[name="username"]');
        const phoneNumberInput = document.querySelector('input[name="phone_number"]');
        const username = usernameInput.value.trim();
        const phoneNumber = phoneNumberInput.value.trim();

        if (!username || !phoneNumber) {
            alert("Please enter a valid username and phone number.");
            return;
        }

        // Submit the form
        bookingForm.submit();
    });
});
</script>
